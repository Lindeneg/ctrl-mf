!function(){return function t(e,n,o){function r(u,a){if(!n[u]){if(!e[u]){var c="function"==typeof require&&require;if(!a&&c)return c(u,!0);if(i)return i(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var l=n[u]={exports:{}};e[u][0].call(l.exports,function(t){return r(e[u][1][t]||t)},l,l.exports,t,e,n,o)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<o.length;u++)r(o[u]);return r}}()({1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t("./modules/app");window.ControlMouseflowInit=o.ControlMouseflow.start},{"./modules/app":2}],2:[function(t,e,n){"use strict";var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function u(t){try{c(o.next(t))}catch(t){i(t)}}function a(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(u,a)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,u={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,o=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(r=(r=u.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){u.label=i[1];break}if(6===i[0]&&u.label<r[1]){u.label=r[1],r=i;break}if(r&&u.label<r[2]){u.label=r[2],u.ops.push(i);break}r[2]&&u.ops.pop(),u.trys.pop();continue}i=e.call(t,u)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.ControlMouseflow=void 0;var i=t("./util"),u=function(){function t(t,e,n,o){this.wid=t,this.locationRule=e,this.optionalRule=n,this.debug=o,this.log("starting module"),this.sessionInitiated=i.isSessionInitiated(this.wid),this.sessionInitiated?this.log("mouseflow session cookie found"):this.log("mouseflow session cookie not found"),this.onDesiredPage=this.isOnDesiredPage()}return t.prototype.log=function(t){i.logger(this.debug,t)},t.prototype.init=function(){this.onDesiredPage&&(this.sessionInitiated?this.injectMouseflow():function(t){o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return[4,t.isFromDesiredCountry()];case 1:return e.sent()&&t.injectMouseflow(),[2]}})})}(this))},t.prototype.isOnDesiredPage=function(){var t=window.document.location.pathname,e=!1;if(this.optionalRule.pageRules.length>0)for(var n=0;n<this.optionalRule.pageRules.length;n++){var o=this.optionalRule.pageRules[n];if(i.matchPath(o.pathname,t)){if(i.recordingRateMatch(o.recordingRate))return this.log("page '"+t+"' matched in rule set | recordingRate matched"),!0;this.log("page '"+t+"' matched in rule set | recordingRate not matched"),e=!0}}return!e&&i.isNumber(this.optionalRule.rest.recordingRate)&&i.recordingRateMatch(this.optionalRule.rest.recordingRate)?(this.log("page '"+t+"' not matched in rule set | recordingRate matched"),!0):(!e&&this.log("page '"+t+"' not matched in rule set | recordingRate not matched"),!1)},t.prototype.isFromDesiredCountry=function(){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,i.getAndMatchLocation(this.locationRule,this.debug)];case 1:return[2,t.sent()]}})})},t.prototype.injectMouseflow=function(){var t,e;this.log("injecting mouseflow"),window._mfq=window._mfq||[],t=this.wid,(e=document.createElement("script")).type="text/javascript",e.defer=!0,e.src="//cdn.mouseflow.com/projects/"+t+".js",document.getElementsByTagName("head")[0].appendChild(e)},t.start=function(e){var n=i.validateConfig(e);n.isValid&&new t(n.websiteId,n.locationRule,n.optionalRule,n.debug).init()},t}();n.ControlMouseflow=u},{"./util":3}],3:[function(t,e,n){"use strict";var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function u(t){try{c(o.next(t))}catch(t){i(t)}}function a(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(u,a)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,u={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,o=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(r=(r=u.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){u.label=i[1];break}if(6===i[0]&&u.label<r[1]){u.label=r[1],r=i;break}if(r&&u.label<r[2]){u.label=r[2],u.ops.push(i);break}r[2]&&u.ops.pop(),u.trys.pop();continue}i=e.call(t,u)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.matchPath=n.getAndMatchLocation=n.isNumber=n.recordingRateMatch=n.validateConfig=n.isSessionInitiated=n.logger=void 0;var i=function(t){return o(void 0,void 0,void 0,function(){var e;return r(this,function(n){switch(n.label){case 0:return[4,fetch(t)];case 1:return 200===(e=n.sent()).status?[2,e.text()]:[2,""]}})})},u=function(t,e,n){for(var o=t.split("\n"),r=0;r<o.length;r++){var i=o[r].split("="),u=i[0],a=i[1];if("LOC"===u.toUpperCase()&&c(a.toLowerCase(),e,n))return!0}return!1},a=function(t,e,n){return c(t.country.toLowerCase(),e,n)},c=function(t,e,o){if(e.countryCodes.length>0)for(var r=0;r<e.countryCodes.length;r++)if(e.countryCodes[r].toLowerCase()===t)return n.logger(o,"matched country: "+t+" include: "+e.include),e.include;return n.logger(o,"not matched country: "+t+" include: "+!e.include),!e.include};n.logger=function(t,e){t&&console.log("ControlMouseflowDebug: "+e)},n.isSessionInitiated=function(t){return new RegExp("mf_"+t).test(document.cookie)},n.validateConfig=function(t){if(!/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(t.websiteId))throw Error("invalid websiteId provided");if(void 0===t.locationRule.include||void 0===t.locationRule.countryCodes||void 0!==t.locationRule.countryCodes&&t.locationRule.countryCodes.length<=0)throw Error("invalid locationRule provided");return t.optionalRule=t.optionalRule||{pageRules:[],rest:{recordingRate:100}},t.debug=t.debug||!1,t.isValid=!0,t},n.recordingRateMatch=function(t){return Math.floor(100*Math.random()+1)<=t},n.isNumber=function(t){return void 0!==t&&"number"==typeof t&&!Number.isNaN(t)},n.getAndMatchLocation=function(t,e){return o(void 0,void 0,void 0,function(){var c,s;return r(this,function(l){switch(l.label){case 0:return[4,function(t){return n.logger(t,"fetching client location from cloudflare"),i("/cdn-cgi/trace")}(e)];case 1:return(s=l.sent())?[3,3]:[4,function(t){return n.logger(t,"fetching client location from ipapi.co"),i("https://ipapi.co/json/")}(e)];case 2:s=l.sent(),l.label=3;case 3:return[2,!(c=s)||function(t,e,n){return o(void 0,void 0,void 0,function(){var o,i;return r(this,function(r){o=!1;try{i=JSON.parse(t),o=a(i,e,n)}catch(r){o=u(t,e,n)}return[2,o]})})}(c,t,e)]}})})},n.matchPath=function(t,e){t=t.toLowerCase(),e=e.toLowerCase();var n=/.+?(?=\.)/.exec(t);return n?n[0]===e:t===e}},{}]},{},[1]);